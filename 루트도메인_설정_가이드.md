# 루트 도메인 설정 가이드 (webapperp.ai.kr)

## 🎯 문제

- ✅ `www.webapperp.ai.kr` → 정상 작동
- ❌ `webapperp.ai.kr` (www 없이) → 접속 안 됨

## 🔍 원인

Azure Static Web Apps는 **CNAME 레코드**만 지원하며, 루트 도메인(apex domain)에는 CNAME을 사용할 수 없습니다.

## ✅ 해결 방법

### 방법 1: DNS 웹 리다이렉트 (권장)

대부분의 도메인 등록 업체에서 웹 리다이렉트 기능을 제공합니다.

#### 가비아에서 설정:

1. [My가비아](https://my.gabia.com) 로그인
2. **도메인** → **부가서비스** → **URL 리다이렉트 관리**
3. **리다이렉트 추가**
   ```
   원본 도메인: webapperp.ai.kr
   대상 URL: https://www.webapperp.ai.kr
   리다이렉트 타입: 301 (영구 리다이렉트)
   ```
4. **저장**

#### 후이즈에서 설정:

1. [후이즈](https://www.whois.co.kr) 로그인
2. **도메인 관리** → **도메인 포워딩**
3. **포워딩 추가**
   ```
   도메인: webapperp.ai.kr
   포워딩 URL: https://www.webapperp.ai.kr
   타입: 301 리다이렉트
   ```

#### Cloudflare에서 설정:

1. [Cloudflare Dashboard](https://dash.cloudflare.com) 로그인
2. **Rules** → **Page Rules**
3. **Create Page Rule**
   ```
   URL: webapperp.ai.kr/*
   Setting: Forwarding URL
   Status Code: 301 - Permanent Redirect
   Destination URL: https://www.webapperp.ai.kr/$1
   ```
4. **Save and Deploy**

### 방법 2: ALIAS/ANAME 레코드 (일부 DNS 제공자만 지원)

일부 DNS 제공자(Cloudflare, Route53, DNSimple 등)는 ALIAS 또는 ANAME 레코드를 지원합니다.

#### Cloudflare에서:

1. **DNS** → **Records**
2. 루트 도메인 (@) A 레코드 삭제
3. **Add record**
   ```
   Type: CNAME
   Name: @
   Target: white-ocean-03a1f7000.3.azurestaticapps.net
   Proxy status: Proxied (주황색 구름)
   ```
4. Cloudflare가 자동으로 CNAME flattening 처리

**참고:** 이 방법은 Cloudflare의 프록시 기능을 사용하므로 추가 설정이 필요할 수 있습니다.

### 방법 3: Azure Front Door 사용 (고급, 추가 비용)

Azure Front Door를 사용하면 루트 도메인을 완전히 지원할 수 있습니다.

#### 장점:
- 루트 도메인 완전 지원
- 추가 성능 최적화
- WAF (웹 방화벽) 기능

#### 단점:
- 추가 비용 발생 (월 약 ₩50,000~)
- 설정이 복잡함

**권장하지 않음** - 현재 프로젝트 규모에는 과도함

## 📋 권장 설정

**가장 간단하고 효과적인 방법:**

1. DNS에서 웹 리다이렉트 설정 (방법 1)
   - `webapperp.ai.kr` → `https://www.webapperp.ai.kr` (301 리다이렉트)

2. SEO를 위해 canonical URL 설정
   - 프론트엔드 `index.html`에 추가:
   ```html
   <link rel="canonical" href="https://www.webapperp.ai.kr/" />
   ```

## 🔍 설정 확인

### 리다이렉트 테스트:

```bash
curl -I http://webapperp.ai.kr/
```

**올바른 결과:**
```
HTTP/1.1 301 Moved Permanently
Location: https://www.webapperp.ai.kr/
```

### 브라우저 테스트:

1. `http://webapperp.ai.kr` 접속
2. 자동으로 `https://www.webapperp.ai.kr`로 이동
3. 주소창에 `www`가 표시됨

## 📊 각 방법 비교

| 방법 | 난이도 | 비용 | 권장도 |
|-----|-------|------|-------|
| DNS 리다이렉트 | 쉬움 | 무료 | ⭐⭐⭐⭐⭐ |
| ALIAS 레코드 | 보통 | 무료 | ⭐⭐⭐ (DNS 지원 시) |
| Azure Front Door | 어려움 | 월 ₩50,000+ | ⭐ (과도함) |

## 💡 추가 팁

### 1. 모든 www 없는 URL을 www로 리다이렉트

검색 엔진에서 중복 컨텐츠로 인식되지 않도록 일관된 URL 사용:
- ✅ `https://www.webapperp.ai.kr` (표준 사용)
- ❌ `https://webapperp.ai.kr` (리다이렉트)

### 2. HSTS 헤더 추가 (이미 설정됨)

현재 Static Web Apps가 자동으로 HSTS 헤더를 추가하고 있습니다:
```
Strict-Transport-Security: max-age=10886400; includeSubDomains; preload
```

### 3. Google Search Console 설정

두 도메인 모두 등록:
1. `www.webapperp.ai.kr` (기본)
2. `webapperp.ai.kr` (리다이렉트 확인용)

## 🆘 문제 해결

### "리다이렉트가 너무 많습니다" 오류

**원인:** 순환 리다이렉트
**해결:**
1. DNS 리다이렉트 설정 확인
2. `webapperp.ai.kr` → `www.webapperp.ai.kr`만 설정 (반대 방향 X)

### SSL 인증서 오류

**원인:** 리다이렉트 전 HTTPS 접속 시도
**해결:**
- DNS 리다이렉트는 HTTP에서 작동
- 최종 목적지 `www.webapperp.ai.kr`에 SSL 적용 (이미 완료)

---

## 📝 실행 단계 요약

1. ✅ 도메인 등록 업체 로그인
2. ✅ URL 리다이렉트/포워딩 메뉴 찾기
3. ✅ `webapperp.ai.kr` → `https://www.webapperp.ai.kr` 설정 (301)
4. ✅ 저장 및 전파 대기 (10분~1시간)
5. ✅ 테스트: `http://webapperp.ai.kr` 접속 → 자동으로 `www`로 이동

완료!
