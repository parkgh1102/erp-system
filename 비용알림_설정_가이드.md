# Azure 비용 알림 설정 가이드

## 🎯 목표

월간 Azure 사용 비용이 설정한 예산을 초과할 경우 이메일 알림 받기

## 📋 설정 단계

### 1. Azure Portal 접속

1. [Azure Portal](https://portal.azure.com) 접속
2. 계정으로 로그인

### 2. Cost Management + Billing 이동

**방법 1: 검색**
- 상단 검색창에 "Cost Management" 입력
- "Cost Management + Billing" 클릭

**방법 2: 메뉴**
- 좌측 메뉴에서 "Cost Management + Billing" 클릭
- (메뉴가 안 보이면 "All services"에서 찾기)

### 3. Budgets 생성

1. 좌측 메뉴에서 **"Cost Management"** 섹션 찾기
2. **"Budgets"** 클릭
3. **"+ Add"** 또는 **"+ Create"** 버튼 클릭

### 4. 예산 세부 정보 입력

#### Scope (범위)
```
Subscription: (본인의 구독 선택)
Resource Group: erp-system-rg (선택사항)
```

#### Budget Details (예산 세부사항)
```
Name: ERP 월간 예산
Reset period: Monthly (월간)
Creation date: (현재 날짜)
Expiration date: (비워두거나 1년 후)
Amount: 100000 (₩100,000)
```

### 5. 알림 조건 설정

**Alert 1: 80% 도달**
```
Alert conditions:
  Type: Actual (실제)
  % of budget: 80%

Alert recipients (email):
  (본인 이메일 주소 입력)
```

**Alert 2: 90% 도달** (선택사항)
```
Alert conditions:
  Type: Actual
  % of budget: 90%

Alert recipients:
  (본인 이메일 주소)
```

**Alert 3: 100% 초과**
```
Alert conditions:
  Type: Actual
  % of budget: 100%

Alert recipients:
  (본인 이메일 주소)
```

### 6. 저장

1. **"Create"** 또는 **"Review + create"** 클릭
2. 설정 확인 후 **"Create"** 클릭

---

## 📧 알림 예시

예산의 80%를 사용하면 다음과 같은 이메일을 받게 됩니다:

```
제목: Azure Cost Alert: ERP 월간 예산

귀하의 구독에서 예산 "ERP 월간 예산"의 80%를
사용했습니다.

현재 비용: ₩80,000 / ₩100,000
기간: 2025-12-01 ~ 2025-12-31

Azure Portal에서 자세한 내용 확인:
[링크]
```

---

## 📊 비용 모니터링 추가 팁

### 1. Cost Analysis (비용 분석)

**경로:** Cost Management + Billing → Cost Analysis

**활용:**
- 일별/월별 비용 추이 확인
- 리소스별 비용 분류
- 예상 월말 비용 확인

### 2. Cost Alerts (비용 알림)

이미 설정한 Budget 외에도:
- Anomaly alerts (이상 감지 알림)
- Invoice alerts (청구서 알림)

### 3. Azure Advisor 권장사항

**경로:** Azure Portal → Advisor → Cost

**확인 사항:**
- 사용하지 않는 리소스 식별
- 비용 절감 기회
- 최적화 권장사항

---

## 💰 예상 월간 비용 재확인

### 현재 설정 기준:

| 리소스 | 타입 | 월 비용 |
|--------|------|---------|
| Azure Static Web Apps | Free | ₩0 |
| App Service Plan | Basic B1 | ₩20,000 |
| PostgreSQL | Burstable B1ms (30일 백업) | ₩15,000 |
| Application Insights | 5GB/월 무료 | ₩0 |
| 네트워크 대역폭 | ~50GB | ₩2,000 |
| **총 예상** | | **₩37,000** |

### 권장 예산 설정:

```
월간 예산: ₩100,000
알림:
  - 80% (₩80,000): 주의
  - 90% (₩90,000): 경고
  - 100% (₩100,000): 긴급
```

---

## 🔔 알림 받지 못하는 경우

### 확인 사항:

1. **이메일 주소 확인**
   - Azure 계정 이메일과 일치하는지 확인
   - 스팸 폴더 확인

2. **알림 설정 확인**
   - Budgets → (생성한 예산) → Alerts
   - 이메일 주소가 올바른지 확인

3. **권한 확인**
   - 구독의 "Cost Management Reader" 이상 권한 필요
   - 리소스 그룹만 선택한 경우 제한적 알림 가능

---

## 🎯 비용 절감 팁

### 1. 개발 환경 자동 종료

개발/테스트 환경은 업무 시간 외 자동 종료:

```bash
# 저녁 6시에 자동 종료
az webapp stop --name erp-backend-app --resource-group erp-system-rg

# 아침 9시에 자동 시작
az webapp start --name erp-backend-app --resource-group erp-system-rg
```

**Azure Automation**으로 스케줄링 가능

### 2. 리소스 그룹 태그 활용

비용 추적을 위한 태그:

```bash
az group update \
  --name erp-system-rg \
  --tags \
    Environment=Production \
    Project=ERP \
    CostCenter=IT \
    Owner=본인이름
```

### 3. 주기적인 리소스 검토

**월 1회:**
- 사용하지 않는 리소스 삭제
- 과도한 스토리지 정리
- 로그 보존 기간 검토

---

## 📱 Azure Mobile App

모바일에서 비용 확인:

1. **Azure Mobile App** 설치 (iOS/Android)
2. 로그인
3. **Cost Management** → **Budgets** 확인
4. 푸시 알림 활성화 (선택)

---

## 🆘 비용 초과 시 대응

### 즉시 조치:

1. **Cost Analysis에서 원인 파악**
   - 어느 리소스가 비용 증가 원인인지 확인

2. **불필요한 리소스 정지**
   ```bash
   # 백엔드 임시 중지
   az webapp stop --name erp-backend-app --resource-group erp-system-rg
   ```

3. **스케일 다운**
   ```bash
   # App Service 플랜 다운그레이드
   az appservice plan update \
     --name erp-backend-plan \
     --resource-group erp-system-rg \
     --sku F1  # Free 티어로 변경 (개발용)
   ```

### 장기 대책:

1. **예약 인스턴스** (1년/3년 약정 시 할인)
2. **개발/프로덕션 환경 분리**
3. **CDN 캐싱 강화** (대역폭 비용 절감)

---

## 📞 추가 도움

Azure 비용 관련 문의:
- [Azure 가격 계산기](https://azure.microsoft.com/pricing/calculator/)
- [Azure 비용 최적화 가이드](https://docs.microsoft.com/azure/cost-management-billing/)
- Azure 지원 (유료 플랜 가입 시)

---

## ✅ 체크리스트

- [ ] Azure Portal에서 Cost Management 접속
- [ ] Budget 생성 (₩100,000)
- [ ] 알림 설정 (80%, 90%, 100%)
- [ ] 이메일 주소 확인
- [ ] 테스트 알림 확인 (선택)
- [ ] Azure Mobile App 설치 (선택)
- [ ] 월 1회 Cost Analysis 검토 일정 설정

완료!
